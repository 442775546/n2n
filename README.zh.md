
<!-- by 文荣平 -->
### 快速设置
- **安装方式**：部分Linux发行版已将 `n2n` 作为软件包提供，可使用 `sudo apt install n2n` 进行安装。此外，大多数发行版的最新软件包可在 [ntop repositories](http://packages.ntop.org/) 中获取。
- **示例配置**：在不同主机上配置边缘节点的示例如下：
```sh



# 以sudo权限运行edge命令，配置n2n边缘节点
# -c 参数指定社区名称为 mynetwork
# -k 参数指定加密密钥为 mysecretpass
# -a 参数指定本地IP地址为 192.168.100.1
# -f 参数表示以前台模式运行
# -l 参数指定连接到的超级节点为 supernode.ntop.org:7777

```
    - 主机1：
```sh
sudo edge -c mynetwork -k mysecretpass -a 192.168.100.1 -f -l supernode.ntop.org:7777
```

    - 主机2：
```sh
sudo edge -c mynetwork -k mysecretpass -a 192.168.100.2 -f -l supernode.ntop.org:7777
```

配置完成后，两台主机可以相互ping通。强烈建议选择自定义社区名称（`-c`）和秘密加密密钥（`-k`），以防止其他用户连接到您的计算机。为保护数据隐私、减少 `supernode.ntop.org` 的服务器负载，还建议设置自定义超级节点。


一、社区与加密密钥设置
1. 自定义社区与密钥
为防止其他用户连接到你的计算机，强烈建议为每个虚拟网络选择自定义的社区名称（使用 -c 参数）和安全的加密密钥（使用 -k 参数）。避免使用默认或简单易猜的社区名和密钥，以确保网络的私密性和安全性。
2. 密钥强度
加密密钥的长度和复杂度会影响加密的安全性。在设置加密密钥时，尽量使用较长且包含多种字符类型（字母、数字、特殊字符）的密钥。较长的密钥可以增加破解的难度，提高数据传输的安全性。
二、超级节点使用安全
1. 自定义超级节点
为了保护数据隐私并减轻公共超级节点（如 supernode.ntop.org）的服务器负载，建议设置自定义的超级节点。按照以下步骤进行设置：
安装 n2n 包。
编辑 /etc/n2n/supernode.conf 文件，添加监听端口，例如 -p=1234。
使用 sudo systemctl start supernode 启动超级节点服务。
可选择使用 sudo systemctl enable supernode 使超级节点在系统启动时自动启动。
2. 端口安全
在设置自定义超级节点时，需要在防火墙（通常是 iptables）上开放指定的端口（如上述示例中的 1234 端口）。确保仅开放必要的端口，并对端口进行适当的访问控制，防止未经授权的访问。
三、数据加密
1. 有效载荷加密
当启用有效载荷加密（通过 -k 参数提供密钥）时，超级节点将无法解密两个边缘节点之间交换的流量，但它仍能知道哪些边缘节点正在通信。这意味着虽然数据内容得到了保护，但通信的拓扑信息仍然可见。
2. 加密方案选择
n2n 边缘节点默认使用 AES 加密。你可以根据需求选择其他加密方案，使用 -A_ 选项指定。不同的加密方案在安全性、性能等方面可能存在差异。建议参考 Crypto description 中的比较图表，根据实际情况选择合适的加密方案。
3. 加密基准测试
如果从源代码编译 n2n，可以使用 tools/n2n-benchmark 对不同的加密方法进行基准测试，以了解它们的性能表现，从而在安全性和性能之间找到平衡。
四、头部加密
元数据保护
边缘节点的头部包含一些元数据，如虚拟 MAC 地址、IP 地址、真实主机名和社区名称等。为了保护这些元数据的隐私，可以在边缘节点上使用 -H 选项对头部进行加密，防止这些信息被泄露。
五、认证与授权
1. 用户 / 密码认证
在使用用户 / 密码基于的认证方式时，超级节点需要进行相应的准备。在 community.list 文件中配置用户和密码信息。如果用户更改密码或需要禁止某个用户访问社区，需要更新或删除 community.list 文件中的相应行，并重启超级节点或向管理端口发送 reload_communities 命令，使更改生效。
2. 管理端口认证
对于管理端口的命令操作，有简单的认证机制。读取操作通常允许，而写入操作可能需要提供正确的认证密码。在 mgmt_auth 函数中实现了基本的认证逻辑，通过比较请求中的密码哈希值与提供的认证密码哈希值来判断是否授权。确保设置安全的管理端口密码，防止未经授权的管理操作。
六、版本与更新
1. 使用稳定版本
一般建议使用最新稳定版本。当前的 dev 分支通常不保证与最新稳定版本或以前的 dev 状态向后兼容。如果要尝试新功能，可以从 dev 分支编译，但需要注意跟踪可能快速发生的变化，并在 Issues 部分提供反馈。
2. 及时更新
定期检查 n2n 的更新，及时安装最新版本，以获取安全补丁和功能改进，确保软件的安全性和稳定性。
七、代码安全
1. 开源代码审查
由于 n2n 是开源软件，你可以审查源代码以了解其实现细节和潜在的安全风险。特别是涉及加密、认证、网络通信等关键功能的代码部分，需要仔细审查。
2. 依赖库安全
n2n 可能依赖于一些外部库，如 OpenSSL 等。确保这些依赖库的版本是安全的，及时更新存在安全漏洞的依赖库。
通过遵循以上安

